> åŸæ–‡: [How to Use Shared Element Transition with Glide in 4 steps](https://www.thedroidsonroids.com/blog/how-to-use-shared-element-transition-with-glide-in-4-steps)  
> ä½œè€…ï¼šBartÅ‚omiej OsmaÅ‚ek  
> Markdown:[åŸæ–‡](https://github.com/iamyours/Translation/blob/master/en/2.How%20to%20Use%20Shared%20Element%20Transition%20with%20Glide%20in%204%20steps.md) | [è¯‘æ–‡](https://github.com/iamyours/Translation/blob/master/zh/2.%E5%9B%9B%E6%AD%A5%E9%80%9A%E8%BF%87Glide%E5%AE%9E%E7%8E%B0%E5%85%B1%E4%BA%AB%E5%85%83%E7%B4%A0%E8%BD%AC%E5%9C%BA%E6%95%88%E6%9E%9C.md)


**è¯»å®Œè¿™ç¯‡æ–‡ç« , ä½ å°±ä¼šçŸ¥é“ä½¿ç”¨Glideç­‰å›¾ç‰‡åŠ è½½åº“å®ç°å…±äº«å…ƒç´ è½¬åœºæ•ˆæœï¼Œä»¥åŠå¦‚ä½•å¤„ç†å„ç§å¯èƒ½åŠ è½½çŠ¶æ€ã€‚é€šè¿‡å…±äº«è½¬åœºåŠ¨ç”»ï¼Œå¯ä»¥æå‡åº”ç”¨äº¤äº’ä½“éªŒï¼Œè®©ç”¨æˆ·ä½¿ç”¨èµ·æ¥æ›´æ„‰æ‚¦**  

![](https://www.thedroidsonroids.com/wp-content/uploads/2018/03/Glide-blogpost-e1523968204264-750x375.jpg)  

å…±äº«å…ƒç´ è½¬åœºæ•ˆæœæ˜¯Material Designçš„ä¸€ä¸ªé‡è¦çš„è½¬åœºæ•ˆæœ. å¦‚æœå›¾ç‰‡èµ„æºæ˜¯é™æ€æœ¬åœ°çš„ï¼Œé‚£ä¹ˆå®ç°èµ·æ¥æ˜¯å®¹æ˜“çš„ã€‚ä½†æ˜¯**é€šè¿‡ç½‘ç»œä¸‹è½½å›¾ç‰‡å¹¶ä¸”åˆ›å»ºä¸€ä¸ªæ— ç¼çš„åŠ¨ç”»æ•ˆæœå°±æ¯”è¾ƒæ£˜æ‰‹äº†ã€‚**

### å¼€å§‹ä¹‹å‰
æ­¤ç¯‡æ–‡ç« æ˜¯åœ¨å¼€å‘[Toast App](https://play.google.com/store/apps/details?id=pl.droidsonroids.toast)æ—¶ï¼Œå¯¹äºè½¬åœºæ•ˆæœçš„ä¸€ä¸ªæ€»ç»“. è¯¥appæ˜¯[TOAST â€“ Android å¼€å‘è€…èšä¼š](https://www.facebook.com/toastwroclaw/)ï¼ˆæ³¢å…°æœ€å¤§çš„Androidå¼€å‘è€…èšä¼šç½‘ç«™ï¼‰çš„å®¢æˆ·ç«¯app. appä¸­åŒ…å«äº†æ¯ä¸ªTOASTäº‹ä»¶ï¼Œå®šæœŸè®²åº§å’Œæ´»åŠ¨ç…§ç‰‡ã€‚ **æˆ‘ä»¬ä¸»è¦ç”¨å…±äº«å…ƒç´ è½¬åœºä½œä¸ºé¡µé¢åˆ‡æ¢æ•ˆæœã€‚åŒæ—¶ä½¿ç”¨[Glide](https://bumptech.github.io/glide/)æ¥è·å–æ‰€æœ‰çš„å›¾ç‰‡ã€‚**

æœ¬æ–‡ä¸­ä»‹ç»çš„æ–¹æ³•ä¹Ÿåº”é€‚ç”¨äºå…¶ä»–å›¾åƒåŠ è½½åº“ï¼Œä¾‹å¦‚[Picasso](https://square.github.io/picasso/) æˆ–è€… [Fresco](http://frescolib.org/) (æ‚¨éœ€è¦æ‰¾åˆ°Glideç‰¹å®šåŠŸèƒ½çš„ç›¸å¯¹åº”çš„ä»£ç å®ç°). **ä¸ºæ­¤æˆ‘åˆ¶ä½œäº†ä¸€ä¸ªç¤ºä¾‹æ¼”ç¤ºç¨‹åº**, å‘å¸ƒåœ¨[Github](https://github.com/DroidsOnRoids/GlideSharedTransition)ä¸Š. æ‰€æœ‰ä»£ç æ®µå‡æ¥è‡ªæ­¤ç¤ºä¾‹ç¨‹åºã€‚ 

**æˆ‘ä»¬ä½¿ç”¨ä¸€ç»„ç½‘æ ¼å›¾ç‰‡ä½œä¸ºå¼€å§‹**. å½“ç”¨æˆ·ç‚¹å‡»ä¸€å¼ å›¾ç‰‡, ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„Activityï¼Œå›¾ç‰‡ä¼šè£å‰ªå¹¶å¡«å……æ•´ä¸ªå±å¹•ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨GlideåŠ è½½å›¾ç‰‡çš„ç›¸å…³ä»£ç :

``` kotlin
fun ImageView.load(url: String) {
    Glide.with(this)
            .load(url)
            .apply(RequestOptions.placeholderOf(R.drawable.placeholder))
            .into(this)
}
```
### æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼š
![](https://media.giphy.com/media/pb1pyVi9DnfVi0KZsE/giphy.gif) 

### ç¬¬ä¸€æ­¥: å¹¼ç¨šçš„å…±äº«è¿‡æ¸¡
æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ æ­£ç¡®`options`æ¥åˆ›å»ºè¿‡æ¸¡æ•ˆæœï¼Œä¿®æ”¹ `goToDetails` æ–¹æ³•å¦‚ä¸‹:  
[MainActivity.kt](https://gist.github.com/Nonda95/53e7b976e77c7adcba53f1c3ca19a174#file-mainactivity-kt)
``` kotlin
fun goToDetails(url: String, imageView: View) {
    val options = ActivityOptionsCompat.makeSceneTransitionAnimation(this, imageView, imageView.transitionName).toBundle()
    Intent(this, DetailActivity::class.java)
            .putExtra(IMAGE_URL_KEY, url)
            .let {
                startActivity(it, options)
            }
}
```

ç°åœ¨, æˆ‘ä»¬åœ¨ä¸Šé¢çš„æ–¹æ³•ä¸­ä¼ å…¥è¦å…±äº«çš„viewï¼Œå¹¶è®¾ç½®`transitionName`ã€‚**è¿™ä¸ªåç§°åœ¨æ¯ä¸ªactivityä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä¸»è§†å›¾å’Œè¯¦æƒ…é¡µé¢ç›¸å¯¹åº”çš„viewçš„transitionNameåˆ™è¦ç›¸åŒ**ï¼Œåœ¨æ­¤ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬ä½¿ç”¨å›¾ç‰‡urlä½œä¸º`transitionName`:  
[DetailActivity.kt](https://gist.github.com/Nonda95/22c4206ee838bb483b782285d7f92e61#file-detailactivity-kt)
``` kotlin
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    setContentView(R.layout.activity_detail)
    val url = intent.getStringExtra(IMAGE_URL_KEY)
    detailImage.transitionName = url
    detailImage.load(url)
}
```
[ImageAdapter.kt](https://gist.github.com/Nonda95/22c4206ee838bb483b782285d7f92e61#file-imageadapter-kt)
``` kotlin
inner class ImageViewHolder(view: View) : RecyclerView.ViewHolder(view) {
    fun bind(url: String) {
        (itemView as ImageView).apply {
            load(url)
            transitionName = url
            setOnClickListener { onClick(url, it) }
        }
    }
}
```
å¥½äº†, æˆ‘ä»¬æœ‰äº†è¿‡æ¸¡åŠ¨ç”»å¦‚ä¸‹:  

![](https://media.giphy.com/media/B2TTV3XNP9nnlGS19d/giphy.gif). 

ç³Ÿç³•çš„æ˜¯è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœğŸ™  

### ç¬¬äºŒæ­¥: æ¨è¿Ÿè¿‡æ¸¡æ•ˆæœ
Glideéœ€è¦æ—¶é—´å°†å›¾ç‰‡åŠ è½½åˆ°ImageView. è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨`onCreate`ä¸­ **æˆ‘ä»¬ä¸å¾—ä¸æ¨è¿Ÿè¿‡è¿‡æ¸¡åŠ¨ç”»æ•ˆæœ**ï¼Œç›´åˆ°å›¾ç‰‡ä¸‹è½½å®Œæˆæ‰å¯ä»¥å¼€å§‹è¿›è¡Œè¿‡æ¸¡æ•ˆæœ:
[DetailActivity.kt](https://gist.github.com/Nonda95/29a4904be147ddb3466a628c649a88c3#file-detailactivity-kt)
``` kotlin
override fun onCreate(savedInstanceState: Bundle?) {
    ...
    supportPostponeEnterTransition()
    detailImage.load(url) {
        supportStartPostponedEnterTransition()
    }
}
```
[GlideLoader.kt](https://gist.github.com/Nonda95/29a4904be147ddb3466a628c649a88c3#file-glideloader-kt)
``` kotlin
fun ImageView.load(url: String, onLoadingFinished: () -> Unit = {}) {
    val listener = object : RequestListener<Drawable> {
        override fun onLoadFailed(e: GlideException?, model: Any?, target: Target<Drawable>?, isFirstResource: Boolean): Boolean {
            onLoadingFinished()
            return false
        }

        override fun onResourceReady(resource: Drawable?, model: Any?, target: Target<Drawable>?, dataSource: DataSource?, isFirstResource: Boolean): Boolean {
            onLoadingFinished()
            return false
        }
    }
    Glide.with(this)
            .load(url)
            .apply(RequestOptions.placeholderOf(R.drawable.placeholder))
            .listener(listener)
            .into(this)
}
```
![](https://media.giphy.com/media/1mgP2w8cu8b5vxsdUY/giphy.gif)

ç°åœ¨æˆ‘ä»¬åœ¨è¿‡æ¸¡å‰å›¾ç‰‡å·²ç»åŠ è½½äº†ï¼Œä½†å¯ä»¥çœ‹åˆ°çš„æ˜¯åœ¨è¿›å…¥è¿‡æ¸¡ä¹‹å‰ä»¥åŠé€€å‡ºè¿‡æ¸¡ä¹‹åä¼šæœ‰å¥‡æ€ªçš„æ¯›åˆºï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€æ­¥å¤„ç†å®ƒã€‚  

### ç¬¬ä¸‰æ­¥: ç¦æ­¢è½¬æ¢

ä¹‹æ‰€ä»¥æœ‰è¿™ä¸ªæ¯›åˆºæ•ˆæœæ˜¯ç”±äºGlideåœ¨åŠ è½½æ—¶è¿›è¡Œçš„ä¼˜åŒ–ã€‚ é»˜è®¤çš„, Glideä¸ºäº†åŒ¹é…ç›®æ ‡viewä¼šè°ƒæ•´å›¾ç‰‡å¤§å°å¹¶è£å‰ªå›¾ç‰‡ã€‚ä½†æ˜¯Androidè¿‡æ¸¡æ¡†æ¶åœ¨è¿‡æ¸¡å¼€å§‹æ—¶ä¼šä»ç›®æ ‡è§†å›¾è·å–å›¾åƒï¼Œå¹¶ä¸”å°†å®ƒè½¬æ¢åˆ°æºè§†å›¾çš„å›¾åƒã€‚**æˆ‘ä»¬å¯ä»¥è®©Glideä¸è¿›è¡Œè¿™äº›ä¼˜åŒ–:**   
[GlideLoader.kt](https://gist.github.com/Nonda95/2942cc419a9ad0f7c01eb6229be35ed8#file-glideloader-kt)
``` kotlin
fun ImageView.load(url: String, onLoadingFinished: () -> Unit = {}) {
    ...
    val requestOptions = RequestOptions.placeholderOf(R.drawable.placeholder)
            .dontTransform()
    Glide.with(this)
            .load(url)
            .apply(requestOptions)
            .listener(listener)
            .into(this)
}
```

> **æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨Glideä¸­ä½¿ç”¨åŸå§‹å›¾ç‰‡å¤§å°ã€‚** è¿™ä¼šå‡å°‘è¿‡æ¸¡å»¶è¿Ÿï¼Œå› ä¸ºåŸå§‹å›¾ç‰‡ä¼šå­˜åœ¨äºå†…å­˜ä¸­ï¼Œä¸ä¼šåœ¨ç£ç›˜ç¼“å­˜ä¸­ã€‚æ³¨æ„ï¼šæ­¤æ“ä½œä¼šè®©ä½ çš„çš„ç¨‹åºå˜æ…¢ï¼Œéœ€è¦å°å¿ƒä½¿ç”¨ã€‚å¦‚æœä½ ä¸€å®šè¦è¿™æ ·åšçš„èŠ±ï¼Œè¿™é‡Œæœ‰ä¸ª[ä¿®æ”¹çš„åˆ†æ”¯](https://github.com/DroidsOnRoids/GlideSharedTransition/tree/orginal-size)å¯ä»¥å‚è€ƒä¸‹.   

![](https://media.giphy.com/media/PKL7wWhDf0j8RbphHz/giphy.gif)

ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†,ä½†åœ¨ä¸€äº›é”™è¯¯é“¾æ¥å›¾ç‰‡è·å–æœªåŠ è½½å®Œæˆä½†å›¾ç‰‡å°±ä¼šæœ‰ä¸€ä¸ªå°é—®é¢˜ã€‚     

![](https://media.giphy.com/media/1kTNPRQBPG9GJinzaP/giphy.gif)

### ç¬¬å››æ­¥: ä»…åœ¨Cacheæ—¶ä¼ è¾“
æˆ‘ä»¬è¦åœ¨ä»»ä½•æ¡ä»¶ä¸‹éƒ½å¯ä»¥æ— ç¼è¿‡æ¸¡ï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯**ä»ç¼“å­˜ä¸­è·å–å›¾ç‰‡** (æˆ–è€…å¦‚æœå›¾ç‰‡æœªåŠ è½½å®Œæˆæ—¶, å°±**ä½¿ç”¨å ä½å›¾**)ã€‚
[DetailActivity.kt](https://gist.github.com/Nonda95/145c9cfae9780a85d8a3f60c35853aed#file-detailactivity-kt)
``` kotlin
override fun onCreate(savedInstanceState: Bundle?) {
    ...
    detailImage.load(url, loadOnlyFromCache = true) {
        supportStartPostponedEnterTransition()
    }
}
```
[GlideLoader.kt](https://gist.github.com/Nonda95/145c9cfae9780a85d8a3f60c35853aed#file-glideloader-kt)
``` kotlin
fun ImageView.load(url: String, loadOnlyFromCache: Boolean = false, onLoadingFinished: () -> Unit = {}) {
    ...
    val requestOptions = RequestOptions.placeholderOf(R.drawable.placeholder)
            .dontTransform()
            .onlyRetrieveFromCache(loadOnlyFromCache)
    ...
}
```
![](https://media.giphy.com/media/MU3Af98As5cpUPhf9r/giphy.gif)  

å½“ç„¶ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·æ‰“å¼€è¯¦æƒ…é¡µé¢æ—¶ï¼Œåœ¨å›¾ç‰‡åŠ è½½å®Œæˆä¹‹å‰ï¼Œåªä¼šæ˜¾ç¤ºå ä½å›¾ã€‚å®ƒä¼šåœ¨è¿‡æ¸¡ç»“æŸåé€šè¿‡**ç¬¬äºŒæ¬¡è¯·æ±‚**æ¥ä¿®å¤ï¼š   
[DetailActivity.kt](https://gist.github.com/Nonda95/95d57d45fdf0590c3e804885ed211220#file-detailactivity-kt)
``` kotlin
override fun onCreate(savedInstanceState: Bundle?) {
    ...
    window.sharedElementEnterTransition = TransitionSet()
            .addTransition(ChangeImageTransform())
            .addTransition(ChangeBounds())
            .apply {
                doOnEnd { detailImage.load(url) }
            }
}	
```
![](https://media.giphy.com/media/521OqXH8I5SzFEKW6R/giphy.gif)  

æœ€ç»ˆï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªéå¸¸æ£’çš„è¿‡æ¸¡è½¬åœºæ•ˆæœï¼Œå®ƒå¯ä»¥å·¥ä½œåœ¨å„ç§æ¡ä»¶ä¸‹ã€‚æ‚¨å¯ä»¥åœ¨GitHubä¸ŠæŸ¥çœ‹æ•´ä¸ªç¤ºä¾‹ï¼Œä¹Ÿå¯ä»¥åœ¨Toast Appä¸­æŸ¥çœ‹æ›´å¤šç¤ºä¾‹ã€‚

### æ€»ç»“
å…±äº«å…ƒç´ è¿‡æ¸¡æä¾›äº†è§†è§‰ä¸Šçš„è¿ç»­æ€§ï¼Œå¹¶ä¿æŒäº†ç”¨æˆ·çš„æ³¨æ„åŠ›ã€‚ ä½†æ˜¯æˆ‘ä»¬åº”è¯¥è®°ä½ï¼Œæˆ‘ä»¬çš„äº’è”ç½‘è¿æ¥å¯èƒ½å¾ˆå·®ï¼Œå†»ç»“çš„è¿‡æ¸¡å¯èƒ½ä¼šæ¿€æ€’ç”¨æˆ·ã€‚ æˆ‘ç›¸ä¿¡è¿™4ä¸ªæ­¥éª¤å°†åœ¨ä»»ä½•æƒ…å†µä¸‹å¸®åŠ©æ‚¨ä½¿æ‚¨çš„åº”ç”¨ç¨‹åºç¾è§‚ä¸”å¿«é€Ÿã€‚

### ç›¸å…³é“¾æ¥
[Workcation App â€“ Part 4. Shared Element Transition with RecyclerView and Scenes](https://www.thedroidsonroids.com/blog/workcation-app-part-4-shared-element-transition-recyclerview-scenes)    
[Meaningful Motion with Shared Element Transition and Circular Reveal Animation](https://www.thedroidsonroids.com/blog/meaningful-motion-with-shared-element-transition-and-circular-reveal-animation)  
[Workcation App â€“ Part 1. Fragment custom transition](https://www.thedroidsonroids.com/blog/workcation-app-part-1-fragments-custom-transition)  
[How to Learn Android Development Programming â€“ 6 Steps for Beginners](https://www.thedroidsonroids.com/blog/how-to-learn-android-development-programming)  
[6 Misconceptions about TDD â€“ Part 4. There is one right granularity of steps](https://www.thedroidsonroids.com/blog/6-misconceptions-about-tdd-part-4-steps-size)  
